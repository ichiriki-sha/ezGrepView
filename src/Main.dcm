VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Main"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Option Explicit

'-------------------------------------------------------------------------------
' イベント名 : BrowseButton_Click
' 概要       : 「...」ボタン押下時に呼ばれる。
'              実際の処理は BrowseAndSetFilePath で実行する。
'              処理内容：
'                ・ファイル選択ダイアログ表示
'                ・選択ファイルパスを環境変数表記に変換
'                ・メインシートの指定セルに設定
'-------------------------------------------------------------------------------
Private Sub BrowseButton_Click()
    
    BrowseAndSetFilePath
End Sub

'-------------------------------------------------------------------------------
' イベント名 : ImportButton_Click
' 概要       : [インポート]ボタン押下時に呼ばれる。
'              実際の処理は ImportData 関数で実行する。
'              このボタンクリックイベントは、UI からのトリガー専用。
'-------------------------------------------------------------------------------
Private Sub ImportButton_Click()
    
    ImportData
End Sub

'-------------------------------------------------------------------------------
' イベント名 : Worksheet_Change
' 概要       : メインシートのファイルパス入力セルが変更された際に呼ばれる。
'              処理内容：
'                ・入力されたパスを環境変数表記（例：%USERPROFILE%）に変換
'                ・変換結果が元の値と異なる場合のみセルを書き換える
' 引数       : Target - 変更されたセル範囲
'-------------------------------------------------------------------------------
Private Sub Worksheet_Change(ByVal target As Range)
    
    If Not Intersect(target, Range(ADDR_MAIN_RESULT_PATH)) Is Nothing Then
        
        ConvertFilePathToEnvVar target
    End If
End Sub
